{% extends 'layouts/page.njk' %}

{% from "govuk/components/phase-banner/macro.njk" import govukPhaseBanner %}
{% from "govuk/components/textarea/macro.njk" import govukTextarea %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}

{% block beforeContent %}
  {{ govukPhaseBanner({
    tag: {
      text: phaseTag
    },
    html: phaseTagText
  }) }}
{% endblock %}

{% block content %}

  {{ appHeading({ text: heading }) }}

  <a class="govuk-skip-link" href="#question-form">Skip to question entry</a>

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      {% if error %}
        {{ govukErrorSummary({
          titleText: "There is a problem",
          errorList: [
            {
              text: error,
              href: "#question"
            }
          ]
        }) }}
      {% endif %}

      <div class="govuk-warning-text">
        <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
        <strong class="govuk-warning-text__text">
          <span class="govuk-warning-text__assistive">Important:</span>
          This tool uses generative AI. Answers may be incomplete or inaccurate.
          Please check the sources listed under each answer and use the transcript or human support if needed.
          <a class="govuk-link" href="/how-we-generate-answers" target="_blank" rel="noopener">Find out how this AI works</a>.
        </strong>
      </div>

      <div id="question-form">
        <form action="/" method="post" novalidate>
          {% set textareaOptions = {
            name: "question",
            id: "question",
            value: question,
            label: {
              text: "What would you like to know about AI guidance or information?",
              classes: "govuk-label--m"
            },
            hint: {
              text: "Enter a specific question, for example ‘What are the ethics guidelines for AI in government?’ or select a popular topic below to prefill this box."
            },
            attributes: {
              "data-testid": "question-input"
            },
            rows: 3
          } %}

          {% if error %}
            {% set textareaOptions = textareaOptions | merge({ errorMessage: { text: error } }) %}
          {% endif %}

          {{ govukTextarea(textareaOptions) }}

          {{ govukButton({
            text: "Ask question",
            type: "submit",
            attributes: {
              "data-testid": "submit-question"
            }
          }) }}
        </form>
      </div>
    </div>
    <div class="govuk-grid-column-one-third">
      <div class="govuk-body">
        <h3 class="govuk-heading-s">Popular topics</h3>
        <p class="govuk-body">Select a topic to prefill your question:</p>
        <ul class="govuk-list govuk-list--bullet">
          <li><a class="govuk-link" href="?question=AI%20ethics%20and%20governance">AI ethics and governance</a></li>
          <li><a class="govuk-link" href="?question=Data%20protection%20in%20AI%20systems">Data protection in AI systems</a></li>
          <li><a class="govuk-link" href="?question=AI%20procurement%20guidelines">AI procurement guidelines</a></li>
          <li><a class="govuk-link" href="?question=Risk%20assessment%20frameworks">Risk assessment frameworks</a></li>
          <li><a class="govuk-link" href="?question=AI%20implementation%20best%20practices">AI implementation best practices</a></li>
        </ul>
      </div>
    </div>
  </div>

{% endblock %}
